FROM @PROTONSDK_URLBASE@/binutils-i686-linux-gnu:@BINUTILS_VERSION@ AS binutils-linux-i686
FROM @PROTONSDK_URLBASE@/binutils-x86_64-linux-gnu:@BINUTILS_VERSION@ AS binutils-linux-x86_64
FROM @PROTONSDK_URLBASE@/mingw-llvm-i686:@LLVM_VERSION@ AS mingw-llvm-i686
FROM @PROTONSDK_URLBASE@/mingw-llvm-x86_64:@LLVM_VERSION@ AS mingw-llvm-x86_64
FROM @PROTONSDK_URLBASE@/mingw-headers-llvm-i686:@MINGW_VERSION@ AS mingw-headers-i686
FROM @PROTONSDK_URLBASE@/mingw-headers-llvm-x86_64:@MINGW_VERSION@ AS mingw-headers-x86_64
FROM @PROTONSDK_URLBASE@/mingw-crt-llvm-i686:@MINGW_VERSION@ AS mingw-crt-llvm-i686
FROM @PROTONSDK_URLBASE@/mingw-crt-llvm-x86_64:@MINGW_VERSION@ AS mingw-crt-llvm-x86_64
FROM @PROTONSDK_URLBASE@/mingw-pthreads-llvm-i686:@MINGW_VERSION@ AS mingw-pthreads-llvm-i686
FROM @PROTONSDK_URLBASE@/mingw-pthreads-llvm-x86_64:@MINGW_VERSION@ AS mingw-pthreads-llvm-x86_64
FROM @PROTONSDK_URLBASE@/mingw-libcxx-i686:@LLVM_VERSION@ AS mingw-libcxx-i686
FROM @PROTONSDK_URLBASE@/mingw-libcxx-x86_64:@LLVM_VERSION@ AS mingw-libcxx-x86_64
FROM @PROTONSDK_URLBASE@/mingw-compiler-rt-i686:@LLVM_VERSION@ AS mingw-compiler-rt-i686
FROM @PROTONSDK_URLBASE@/mingw-compiler-rt-x86_64:@LLVM_VERSION@ AS mingw-compiler-rt-x86_64
FROM @PROTONSDK_URLBASE@/mingw-widl-i686:@MINGW_VERSION@ AS mingw-widl-i686
FROM @PROTONSDK_URLBASE@/mingw-widl-x86_64:@MINGW_VERSION@ AS mingw-widl-x86_64
FROM @PROTONSDK_URLBASE@/gcc-i686-linux-gnu:@GCC_VERSION@ AS gcc-linux-i686
FROM @PROTONSDK_URLBASE@/gcc-x86_64-linux-gnu:@GCC_VERSION@ AS gcc-linux-x86_64

FROM @BASE_IMAGE@ AS base

COPY --from=binutils-linux-i686        /opt/usr /usr
COPY --from=binutils-linux-x86_64      /opt/usr /usr
COPY --from=mingw-llvm-i686            /opt/usr /usr
COPY --from=mingw-llvm-x86_64          /opt/usr /usr
COPY --from=mingw-headers-i686         /opt/usr /usr
COPY --from=mingw-headers-x86_64       /opt/usr /usr
COPY --from=mingw-crt-llvm-i686        /opt/usr /usr
COPY --from=mingw-crt-llvm-x86_64      /opt/usr /usr
COPY --from=mingw-pthreads-llvm-i686   /opt/usr /usr
COPY --from=mingw-pthreads-llvm-x86_64 /opt/usr /usr
COPY --from=mingw-libcxx-i686          /opt/usr /usr
COPY --from=mingw-libcxx-x86_64        /opt/usr /usr
COPY --from=mingw-compiler-rt-i686     /opt/usr /usr
COPY --from=mingw-compiler-rt-x86_64   /opt/usr /usr
COPY --from=mingw-widl-i686            /opt/usr /usr
COPY --from=mingw-widl-x86_64          /opt/usr /usr
COPY --from=gcc-linux-i686             /opt/usr /usr
COPY --from=gcc-linux-x86_64           /opt/usr /usr

RUN bash -c 'mkdir -p /usr/lib/ccache && ls /usr/bin/{,*-}{cc,c++,gcc,g++}{,-[0-9]*} | sed -re s:/bin:/lib/ccache: | xargs -n1 ln -sf ../../bin/ccache'
